<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>astrotypes: sigproc_header.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">astrotypes
   &#160;<span id="projectnumber">0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">sigproc_header.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<h3>Reading in Sigproc Data</h3>
<p>Now we have all the information of the header encapsulated in the header object. We can put in some checks to see it is the data we are expecting. </p><div class="fragment"><div class="line"><span class="comment">// check header is what we are expecting</span></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="keywordflow">if</span>( header.data_type() != astro::sigproc::Header::DataType::FilterBank <span class="comment">// FilterBank file</span></div>
<div class="line">    &amp;&amp; header.number_of_bits() != 16                                   <span class="comment">// 16 bit data</span></div>
<div class="line">    &amp;&amp; header.number_of_number_of_nifs() != 1                          <span class="comment">// Stokes I only</span></div>
<div class="line">   )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;unexpected file format&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Our next task is to read in the data into a suitable data structure. We do this using the SigProcFormat templated Adapter. The template arguments must be consistent with the header.data_type(). The code below will read if FilterBank types. Swap the template parameters if this is TimeSeries data.</p>
<div class="fragment"><div class="line">astro::DimensionSize&lt;astro::units::Frequency&gt; chunk_size(1000); <span class="comment">// a thousand samples at a time</span></div>
<div class="line">astro::TimeFrequency&lt;uint16_t&gt; data(header.number_of_channels(), chunk_size);</div>
<div class="line"><span class="keywordflow">while</span>(!in.eof()) {</div>
<div class="line">    in &gt;&gt; SigProcFormat&lt;astro::units::Time, astro::units::Frequency&gt;() &gt;&gt; data;</div>
<div class="line">    do_something_with_the_data(data);</div>
<div class="line">}</div>
</div><!-- fragment --><p>You can also write out to a std::ostream using the same SigProcFormat class. </p><div class="fragment"><div class="line"><span class="comment">// e.g. where header data_type is FilterBank</span></div>
<div class="line">std::ofstream out(<span class="stringliteral">&quot;output_data.fil&quot;</span>);</div>
<div class="line">out &lt;&lt; header;</div>
<div class="line">out &lt;&lt; SigProcFormat&lt;astro::units::Time, astro::units::Frequency&gt;() &lt;&lt; data;</div>
</div><!-- fragment --><h2>More Generic Applications</h2>
<p>If you are writing an application that needs to handle all types of sigproc files then you will need to generate code for each different possibilty. This is because our TimeFrequency data types do not, for reasons of runtime speed, inherit from a common base class.</p>
<p>Fortunately this is easier than it sounds. astrotypes::sigproc provides helpers to do this for you and all you need to do is provide a template class for your code.</p>
<div class="fragment"></div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Sep 23 2018 13:07:22 for astrotypes by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
